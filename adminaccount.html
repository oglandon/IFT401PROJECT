<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Proton Trading</title>
        <meta charset="UTF-8">
        <link rel="stylesheet" href="styles.css">
        <link rel="stylesheet" href="adminaccount.css">
    </head>
    
    <body>
        <div id="wrapper">
            <header>
                <section id="top_bar">
                    <nav>
                        <ul>
                            <li><a href="index.html"> <img src="protonlogo.png" class="logo" alt="Proton Logo"></a></li>
                            <li><a href="about.html">About Us</a></li>
                            <li><a href="market.html">Market</a></li>
                            <li><a href="create.html">Create Account</a></li>
                            <li><a href="admin.html">Admin Login</a></li>
                            <li><a href="user.html">User Login</a></li>
                        </ul>
                    </nav>
                </section>
            </header>
        
        <h1>Admin Account.</h1>
        <div class="stock-creation">
            <h2>Create A Stock</h2>
            <form id="newstock">
                <label for="company_name"></label>
                <input type="text" id="company" name="company_name" required placeholder="Company Name">
        
                <label for="ticker"></label>
                <input type="text" id="ticker" name="ticker" required placeholder="Ticker Symbol">
        
                <label for="volume"></label>
                <input type="number" id="volume" name="volume" required placeholder="Volume">
        
                <label for="initial_price"></label>
                <input type="number" step="any" id="price" name="initial_price" required placeholder="Initial Price">
        
                <button type="submit">Create</button>
            </form>
        </div>

        <div class="update-hours">
            <h2>Update Market Hours</h2>
                <form id="markethours" method="POST" action="markethours.cz08cemoiob0.us-east-2.rds.amazonaws.com">
                    <label for="newhours" id="newhours">New Hours:</label><br>
                    <select name="weekday" id="weekday">
                            <option disabled selected>Start Weekday & Time</option>
                            <option> Monday </option>
                            <option> Tuesday </option>
                            <option> Wednesday </option>
                            <option> Thursday </option>
                            <option> Friday </option>
                    </select>
                    <input type="time" id="time" name="time" min="12:00" max="11:59" required>
                    <select name="weekday" id="weekday">
                        <option disabled selected>End Weekday & Time</option>
                        <option> Monday </option>
                        <option> Tuesday </option>
                        <option> Wednesday </option>
                        <option> Thursday </option>
                        <option> Friday </option>
                    </select>
                    <input type="time" id="time" name="time" min="12:00" max="11:59" required>
                    <button type="submit">Submit</button>
                </form>
        </div>

        <div class="portfolio">
            <h2>Your Portfolio</h2>

        </div>

        <div class="history">
            <h2>Transaction History</h2>
                
        </div>

        <div class="funds">
            <h2>Account Funds</h2>
                
        </div>

        <div class="trade">
            <h2>Trade Stocks</h2>
                
        </div>

        <script>
            window.onload = function() {
                document.getElementById("markethours").reset();
                document.getElementById("newstock").reset();
                document.getElementById("funds").reset();
                document.getElementById("trade").reset();
            };
        </script>
        <script>
            document.getElementById('newstock').addEventListener('submit', async (event) => {
                event.preventDefault();  // Prevents the default form submission

                // Gather form data
                const formData = new FormData(event.target);
                
                // Create JSON object
                const data = {
                    company_name: formData.get('company_name'),
                    ticker: formData.get('ticker'),
                    volume: parseInt(formData.get('volume')),
                    initial_price: parseFloat(formData.get('initial_price'))
                };

                try {
                    const response = await fetch('http://127.0.0.1:8000/stocks', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(data)
                    });

                    if (response.ok) {
                        const result = await response.json();
                        alert(`Stock created successfully: ${JSON.stringify(result)}`);
                    } else {
                        const errorData = await response.json();
                        alert(`Error: ${errorData.detail}`);
                    }
                } catch (error) {
                    console.error('Error:', error);
                    alert('Failed to create stock. Check the console for details.');
                }
            });
        </script>